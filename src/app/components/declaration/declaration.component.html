<div class="page-layout d-flex flex-column flex-grow-1 h-100" dir="rtl">
  <div class="page-content flex-grow-1 overflow-auto p-4">

    <!-- Header Section -->
    <div class="d-flex justify-content-between align-items-start mb-4">
      <div>
        <h2 class="fw-bold mb-1">Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
        <p class="text-muted small">Ù‚Ù… Ø¨ÙƒØªØ§Ø¨Ø© Ù†Øµ Ø§Ù„Ø®Ø·Ø§Ø¨ ÙˆØ§Ø³ØªØ®Ø¯Ù… Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©</p>
      </div>
    </div>

    <!-- Card Form -->
    <div class="card shadow-sm p-4 bg-white rounded-4">
      <form [formGroup]="messageForm" (ngSubmit)="onSubmit()">

        <!-- Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø§Ø¨ -->
        <div class="mb-3">
          <label for="type" class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø§Ø¨ *</label>
          <select id="type" formControlName="type" class="form-select">
            <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø§Ø¨...</option>
            <option *ngFor="let t of messageTypes" [value]="t._id">{{ t.title }}</option>
          </select>
        </div>

        <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
        <div class="mb-3">
          <label for="title" class="form-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø·Ø§Ø¨ *</label>
          <input
            id="title"
            type="text"
            formControlName="title"
            placeholder="Ù…Ø«Ø§Ù„: Ø·Ù„Ø¨ ØªØ±Ù‚ÙŠØ© Ù…ÙˆØ¸Ù"
            class="form-control"
          />
        </div>

        <!-- Ø§Ù„Ù…Ø­Ø±Ø± Ø§Ù„Ù†ØµÙŠ -->
        <div class="mb-4">
          <label class="form-label">Ù†Øµ Ø§Ù„Ø®Ø·Ø§Ø¨ *</label>

          <div class="editor-toolbar mb-2">
            <button type="button" (click)="format('bold')"><b>B</b></button>
            <button type="button" (click)="format('italic')"><i>I</i></button>
            <button type="button" (click)="format('underline')"><u>U</u></button>
            <button type="button" (click)="format('insertUnorderedList')">â€¢</button>
            <button type="button" (click)="format('insertOrderedList')">1.</button>
            <button type="button" (click)="format('createLink')">ðŸ”—</button>
            <button type="button" (click)="clear()">ðŸ§¹</button>
          </div>

          <div
            class="editor-area form-control"
            contenteditable="true"
            (input)="onEditorInput($event)"
            (keydown)="onKeyDown($event)"
            #editor
          ></div>

          <small class="text-muted d-block mt-1">
            ðŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù„ØªÙˆØ¶ÙŠØ­ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ù‡Ù…Ø©.
          </small>
        </div>

        <!-- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
        <div *ngIf="successMsg" class="alert alert-success">{{ successMsg }}</div>
        <div *ngIf="errorMsg" class="alert alert-danger">{{ errorMsg }}</div>

        <!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
        <div class="d-flex justify-content-end gap-2 mt-3">
          <button type="button" class="btn btn-outline-secondary" (click)="onCancel()">Ø¥Ù„ØºØ§Ø¡</button>
          <button type="submit" class="btn btn-primary" [disabled]="messageForm.invalid || submitting">
            <i class="bi bi-send-fill me-1"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø®Ø·Ø§Ø¨
          </button>
        </div>

      </form>
    </div>
  </div>
</div>
